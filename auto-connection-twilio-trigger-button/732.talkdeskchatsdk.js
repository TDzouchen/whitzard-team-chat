(self.webpackChunkTalkdeskChatSDK=self.webpackChunkTalkdeskChatSDK||[]).push([[732],{35187:function(t,e,n){"use strict";n.d(e,{I:function(){return r}});var r=0,i=navigator.userAgent.match(/Firefox[\/\s](\d+\.\d+)/);i&&(r=+i[1])},92055:function(t,e,n){"use strict";n.d(e,{C:function(){return u},ee:function(){return c}});var r=n(26253),i=n(22391),o=n(30717),s="nr@context";let a=(0,r.fP)();var u;a.ee?u=a.ee:(u=ee(void 0,"globalEE"),a.ee=u);var c=ee(void 0,"baseEE");function EventContext(){}function ee(t,e){var n={},r={},a={},u={on:addEventListener,addEventListener:addEventListener,removeEventListener:function removeEventListener(t,e){var r=n[t];if(!r)return;for(var i=0;i<r.length;i++)r[i]===e&&r.splice(i,1)},emit:function emit(e,n,i,o,s){!1!==s&&(s=!0);if(c.aborted&&!o)return;t&&s&&t.emit(e,n,i);for(var a=context(i),f=listeners(e),d=f.length,l=0;l<d;l++)f[l].apply(a,n);var h=getBuffer()[r[e]];h&&h.push([u,e,n,a]);return a},get:function getOrCreate(t){return a[t]=a[t]||ee(u,t)},listeners:listeners,context:context,buffer:function bufferEventsByGroup(t,e){var n=getBuffer();if(u.aborted)return;(0,o.D)(t,(function(t,i){e=e||"feature",r[i]=e,e in n||(n[e]=[])}))},abort:abortIfNotLoaded,aborted:!1,isBuffering:function isBuffering(t){return!!getBuffer()[r[t]]},debugId:e};return t||(u.backlog={}),u;function context(t){return t&&t instanceof EventContext?t:t?(0,i.X)(t,s,getNewContext):getNewContext()}function addEventListener(t,e){n[t]=listeners(t).concat(e)}function listeners(t){return n[t]||[]}function getBuffer(){return t?t.backlog:u.backlog}}function getNewContext(){return new EventContext}function abortIfNotLoaded(){(c.backlog.api||c.backlog.feature)&&(c.aborted=!0,c.backlog={})}},1883:function(t,e,n){"use strict";n.d(e,{EM:function(){return i},l_:function(){return o},pr:function(){return handle}});var r=n(92055),i=r.ee.get("handle"),o=r.C.get("handle");function handle(t,e,n,r,o){o?(o.buffer([t],r),o.emit(t,e,n)):(i.buffer([t],r),i.emit(t,e,n))}},74137:function(t,e,n){"use strict";n.d(e,{m:function(){return eventListenerOpts}});var r=!1;try{var i=Object.defineProperty({},"passive",{get:function(){r=!0}});window.addEventListener("testPassive",null,i),window.removeEventListener("testPassive",null,i)}catch(t){}function eventListenerOpts(t){return r?{passive:!0,capture:!!t}:!!t}},46303:function(t,e,n){"use strict";n.d(e,{o:function(){return HarvestScheduler}});var r=n(82624),i=n(95907),o=n(44606),s=n(87024),a=n(46173),u=n(71009),c=n(80406);function conditionallySet(t){var e=(0,c.Mt)(t,"privacy.cookies_enabled");u.s&&e&&function setCookie(){document.cookie="NREUM=s="+Number(new Date)+"&r="+(0,a.u)(document.location.href)+"&p="+(0,a.u)(document.referrer)+"; path=/"}()}class HarvestScheduler extends i.w{constructor(t,e,n){super(n),this.endpoint=t,this.opts=e||{},this.started=!1,this.timeoutHandle=null,this.harvest=new o.Mu(this.sharedContext),(0,s.l)((()=>{this.opts.onUnload&&this.opts.onUnload(),this.harvest.sendFinal(),conditionallySet(this.sharedContext.agentIdentifier)}))}startTimer(t,e){this.interval=t,this.started=!0,this.scheduleHarvest(null!=e?e:this.interval)}stopTimer(){this.started=!1,this.timeoutHandle&&clearTimeout(this.timeoutHandle)}scheduleHarvest(t,e){if(!this.timeoutHandle){var n=this;null==t&&(t=this.interval),this.timeoutHandle=setTimeout((()=>{n.timeoutHandle=null,n.runHarvest(e)}),1e3*t)}}runHarvest(t){var e=this;if(this.opts.getPayload){var n=this.harvest.getSubmitMethod(this.endpoint,t);if(!n)return!1;var i=n.method===r.T.xhr,o=this.opts.getPayload({retry:i});if(o){o="[object Array]"===Object.prototype.toString.call(o)?o:[o];for(var s=0;s<o.length;s++)this.harvest.send(this.endpoint,o[s],t,n,onHarvestFinished,this.sharedContext.agentIdentifier)}}else this.harvest.sendX(this.endpoint,t,onHarvestFinished,this.sharedContext.agentIdentifier);function onHarvestFinished(n){e.onHarvestFinished(t,n)}this.started&&this.scheduleHarvest()}onHarvestFinished(t,e){if(this.opts.onFinished&&this.opts.onFinished(e),e.sent&&e.retry){var n=e.delay||this.opts.retryDelay;this.started&&n?(clearTimeout(this.timeoutHandle),this.timeoutHandle=null,this.scheduleHarvest(n,t)):!this.started&&n&&this.scheduleHarvest(n,t)}}}},44606:function(t,e,n){"use strict";n.d(e,{Mu:function(){return Harvest},y0:function(){return m}});var r=n(30717),i=n(18253),o=n(89247),s=n(82624),a=n(59722);function getLocation(){return""+location}var u=n(80406),c=n(25768),f=n(11249),d=n(77311),l=n(41437),h=n(74137),v=n(31529),g=n(98065);var p=n(95907);var b=!!navigator.sendBeacon,m=v.H>9||0===v.H;class Harvest extends p.w{constructor(t){super(t),this.tooManyRequestsDelay=(0,u.Mt)(this.sharedContext.agentIdentifier,"harvest.tooManyRequestsDelay")||60,this.obfuscator=new g.R(this.sharedContext),this.getScheme=()=>!1===(0,u.Mt)(this.sharedContext.agentIdentifier,"ssl")?"http":"https",this._events={}}sendFinal(){var t=(0,r.D)(this._events,(t=>this.sendX(t,{unload:!0})));return(0,a.u)(t,or)}sendX(t,e,n){var r=getSubmitMethod(t,e);if(!r)return!1;var i={retry:r.method===s.T.xhr};return this.obfuscator.shouldObfuscate()?this.obfuscator.obfuscateAndSend(t,this.createPayload(t,i),e,r,n):this._send(t,this.createPayload(t,i),e,r,n)}send(t,e,n,i,o){var s=createAccumulator(),a=createAccumulator();e.body&&(0,r.D)(e.body,s),e.qs&&(0,r.D)(e.qs,a);var u={body:s(),qs:a()};return(this.obfuscator.shouldObfuscate()?this.obfuscator.obfuscateAndSend:this._send)(t,u,n,i,o)}obfuscateAndSend(t,e,n,r,i){return function applyFnToProps(t,e,n,r){return t&&"object"==typeof t?(n=n||"string",r=r||[],function traverse(t){for(var r in t)t.hasOwnProperty(r)&&("object"==typeof t[r]?traverse(t[r]):typeof t[r]!==n||shouldIgnore(r)||(t[r]=e(t[r])));return t}(t)):t;function shouldIgnore(t){for(var e=!1,n=0;n<r.length;n++)if(r[n]===t){e=!0;break}return e}}(e,((...t)=>this.obfuscator.obfuscateString(...t)),"string",["e"]),this._send(t,e,n,r,i)}_send(t,e,n,r,a){var u=(0,c.C)(this.sharedContext.agentIdentifier);if(!u.errorBeacon)return!1;if(!e.body)return a&&a({sent:!1}),!1;n||(n={});var d=this.getScheme()+"://"+u.errorBeacon+"/"+t+"/1/"+u.licenseKey+this.baseQueryString();e.qs&&(d+=(0,i.j6)(e.qs,(0,f.O)(this.sharedContext.agentIdentifier).maxBytes)),r||(r=getSubmitMethod(t,n));var l,v=r.method,g=r.useBody,p=d;g&&"events"===t?l=e.body.e:g?l=(0,o.P)(e.body):p=d+(0,i.j6)(e.body,(0,f.O)(this.sharedContext.agentIdentifier).maxBytes);var b=v(p,l);a&&v===s.T.xhr&&b.addEventListener("load",(function(){var t={sent:!0};429===this.status?(t.retry=!0,t.delay=this.tooManyRequestsDelay):408!==this.status&&500!==this.status&&503!==this.status||(t.retry=!0),n.needResponse&&(t.responseText=this.responseText),a(t)}),(0,h.m)(!1));return b||v!==s.T.beacon||(b=(v=s.T.img)(d+(0,i.j6)(e.body,(0,f.O)(this.sharedContext.agentIdentifier).maxBytes))),b}baseQueryString(){var t=!0;const e=(0,u.P_)(this.sharedContext.agentIdentifier);var n=(0,f.O)(this.sharedContext.agentIdentifier),r=(0,c.C)(this.sharedContext.agentIdentifier);"privacy"in e&&(t=e.privacy.cookies_enabled);var o=(0,d.f)(getLocation()),s=this.obfuscator.shouldObfuscate()?this.obfuscator.obfuscateString(o):o;return["?a="+r.applicationID,(0,i.wu)("sa",r.sa?""+r.sa:""),(0,i.wu)("v","0.0.9"),transactionNameParam(r),(0,i.wu)("ct",n.customTransaction),"&rst="+(0,l.zO)(),"&ck="+(t?"1":"0"),(0,i.wu)("ref",s),(0,i.wu)("ptid",n.ptid?""+n.ptid:"")].join("")}createPayload(t,e){for(var n=createAccumulator(),i=createAccumulator(),o=this._events[t]&&this._events[t]||[],s=0;s<o.length;s++){var a=o[s](e);a&&(a.body&&(0,r.D)(a.body,n),a.qs&&(0,r.D)(a.qs,i))}return{body:n(),qs:i()}}on(t,e){(this._events[t]||(this._events[t]=[])).push(e)}resetListeners(){(0,r.D)(this._events,(function(t){this._events[t]=[]}))}}function or(t,e){return t||e}function getSubmitMethod(t,e){var n,r;if((e=e||{}).needResponse){if(!m)return!1;r=!0,n=s.T.xhr}else if(e.unload)r=b,n=b?s.T.beacon:s.T.img;else if(m)r=!0,n=s.T.xhr;else{if("events"!==t&&"jserrors"!==t)return!1;n=s.T.img}return{method:n,useBody:r}}function transactionNameParam(t){return t.transactionName?(0,i.wu)("to",t.transactionName):(0,i.wu)("t",t.tNamePlain||"Unnamed Transaction")}function createAccumulator(){var t={},e=!1;return function(n,r){if(r&&r.length&&(t[n]=r,e=!0),e)return t}}},40819:function(t,e,n){"use strict";n.d(e,{VB:function(){return recordSupportability}});var r=n(1883),i="sm";function recordSupportability(t,e){var n=[i,t,{name:t},e];return(0,r.pr)("storeMetric",n,null,"api"),n}},71009:function(t,e,n){"use strict";n.d(e,{s:function(){return u},v:function(){return findStartTime}});var r=n(46173),i=n(97084),o=n(35187),s=n(41437),a=n(14666);let u=!0;function findStartTime(){var t=function findStartWebTiming(){if(o.I&&o.I<9)return;if(a.G)return u=!1,window.performance.timing.navigationStart}()||function findStartCookie(){for(var t=document.cookie.split(" "),e=0;e<t.length;e++)if(0===t[e].indexOf("NREUM=")){for(var n,i,o,s,a=t[e].substring(6).split("&"),u=0;u<a.length;u++)0===a[u].indexOf("s=")?o=a[u].substring(2):0===a[u].indexOf("p=")?";"===(i=a[u].substring(2)).charAt(i.length-1)&&(i=i.substr(0,i.length-1)):0===a[u].indexOf("r=")&&";"===(n=a[u].substring(2)).charAt(n.length-1)&&(n=n.substr(0,n.length-1));if(n){var c=(0,r.u)(document.referrer);(s=c==n)||(s=(0,r.u)(document.location.href)==n&&c==i)}if(s&&o){if((new Date).getTime()-o>6e4)return;return o}}}();t&&((0,i.B)("starttime",t),(0,s.nb)(t))}findStartTime()},97084:function(t,e,n){"use strict";n.d(e,{B:function(){return mark},L:function(){return measure}});var r=n(41437),i={};function mark(t,e){void 0===e&&(e=(0,r.zO)()+(0,r.os)()),i[t]=e}function measure(t,e,n,r){var o=i[n],s=i[r];void 0!==o&&void 0!==s&&t.store("measures",e,{value:s-o})}},87024:function(t,e,n){"use strict";n.d(e,{l:function(){return subscribeToUnload}});var r=n(35187),i=n(48683),o=n.n(i);var s=n(74137);function addE(t,e){return"addEventListener"in window?window.addEventListener(t,e,(0,s.m)(!1)):"attachEvent"in window?window.attachEvent("on"+t,e):void 0}function subscribeToUnload(t){var e=function single(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,o()(arguments)))}}(t);!r.I||navigator.sendBeacon?addE("pagehide",e):addE("beforeunload",e),addE("unload",e)}},77311:function(t,e,n){"use strict";n.d(e,{f:function(){return cleanURL}});var r=/([^?#]*)[^#]*(#[^?]*|$).*/,i=/([^?#]*)().*/;function cleanURL(t,e){return t.replace(e?r:i,"$1$2")}},18253:function(t,e,n){"use strict";n.d(e,{j6:function(){return obj},nI:function(){return fromArray},wu:function(){return param}});var r=n(30717),i=n(89247),o={"%2C":",","%3A":":","%2F":"/","%40":"@","%24":"$","%3B":";"},s=(0,r.D)(o,(function(t){return t})),a=new RegExp(s.join("|"),"g");function real(t){return o[t]}function qs(t){return null==t?"null":encodeURIComponent(t).replace(a,real)}function fromArray(t,e){for(var n=0,r=0;r<t.length;r++)if((n+=t[r].length)>e)return t.slice(0,r).join("");return t.join("")}function obj(t,e){var n=0,o="";return(0,r.D)(t,(function(t,r){var s,a,u=[];if("string"==typeof r)s="&"+t+"="+qs(r),n+=s.length,o+=s;else if(r.length){for(n+=9,a=0;a<r.length&&(s=qs((0,i.P)(r[a])),n+=s.length,!(void 0!==e&&n>=e));a++)u.push(s);o+="&"+t+"=%5B"+u.join(",")+"%5D"}})),o}function param(t,e){return e&&"string"==typeof e?"&"+t+"="+qs(e):""}},83707:function(t,e,n){"use strict";n.d(e,{W:function(){return FeatureBase}});var r=n(92055);class FeatureBase{constructor(t,e){this.agentIdentifier=t,this.aggregator=e,this.ee=r.ee.get(t)}}},22391:function(t,e,n){"use strict";n.d(e,{X:function(){return getOrSet}});var r=Object.prototype.hasOwnProperty;function getOrSet(t,e,n){if(r.call(t,e))return t[e];var i=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(t,e,{value:i,writable:!0,enumerable:!1}),i}catch(t){}return t[e]=i,i}},98065:function(t,e,n){"use strict";n.d(e,{R:function(){return Obfuscator}});var r=n(80406),i=n(95907),o=n(40819),s=window,a=s;function getWindow(){return a}const u={isFileProtocol:isFileProtocol,supportabilityMetricSent:!1};function isFileProtocol(){var t=getWindow();return!(!t.location||!t.location.protocol||"file:"!==t.location.protocol)}isFileProtocol()&&((0,o.VB)("Generic/FileProtocol/Detected"),u.supportabilityMetricSent=!0);var c={regex:/^file:\/\/(.*)/,replacement:"file://OBFUSCATED"};let f=!1;class Obfuscator extends i.w{constructor(t){super(t),f||(this.shouldObfuscate()&&(0,o.VB)("Generic/Obfuscate/Detected"),this.shouldObfuscate()&&!this.validateRules(this.getRules())&&(0,o.VB)("Generic/Obfuscate/Invalid"),f=!0)}shouldObfuscate(){return this.getRules().length>0}getRules(){var t=[],e=(0,r.Mt)(this.sharedContext.agentIdentifier,"obfuscate")||[];return t=t.concat(e),u.isFileProtocol()&&t.push(c),t}validateRules(t){for(var e=!1,n=!1,r=0;r<t.length;r++){"regex"in t[r]?"string"!=typeof t[r].regex&&t[r].regex.constructor!==RegExp&&(console&&console.warn&&console.warn('An obfuscation replacement rule contains a "regex" value with an invalid type (must be a string or RegExp)'),n=!0):(console&&console.warn&&console.warn('An obfuscation replacement rule was detected missing a "regex" value.'),n=!0);var i=t[r].replacement;i&&"string"!=typeof i&&(console&&console.warn&&console.warn('An obfuscation replacement rule contains a "replacement" value with an invalid type (must be a string)'),e=!0)}return!e&&!n}obfuscateString(t,e){if(!t||"string"!=typeof t)return t;for(var n=this.getRules(e),r=t,i=0;i<n.length;i++){var o=n[i].regex,s=n[i].replacement||"*";r=r.replace(o,s)}return r}}},59722:function(t,e,n){"use strict";function reduce(t,e,n){var r=0;for(void 0===n&&(n=t[0],r=1);r<t.length;r++)n=e(n,t[r]);return n}n.d(e,{u:function(){return reduce}})},46173:function(t,e,n){"use strict";function sHash(t){var e,n=0;for(e=0;e<t.length;e++)n+=(e+1)*t.charCodeAt(e);return Math.abs(n)}n.d(e,{u:function(){return sHash}})},89247:function(t,e,n){"use strict";n.d(e,{P:function(){return stringify}});var r=n(30717),i=n(92055),o=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,s={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function stringify(t){try{return str("",{"":t})}catch(t){try{i.ee.emit("internal-error",[t])}catch(t){}}}function quote(t){return o.lastIndex=0,o.test(t)?'"'+t.replace(o,(function(t){var e=s[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function str(t,e){var n=e[t];switch(typeof n){case"string":return quote(n);case"number":return isFinite(n)?String(n):"null";case"boolean":return String(n);case"object":if(!n)return"null";var i=[];if(n instanceof window.Array||"[object Array]"===Object.prototype.toString.apply(n)){for(var o=n.length,s=0;s<o;s+=1)i[s]=str(s,n)||"null";return 0===i.length?"[]":"["+i.join(",")+"]"}return(0,r.D)(n,(function(t){var e=str(t,n);e&&i.push(quote(t)+":"+e)})),0===i.length?"{}":"{"+i.join(",")+"}"}}},82624:function(t,e,n){"use strict";n.d(e,{T:function(){return r}});const r={jsonp:function jsonp(t,jsonp){var e=document.createElement("script");e.type="text/javascript",e.src=t+"&jsonp="+jsonp;var n=document.getElementsByTagName("script")[0];return n.parentNode.insertBefore(e,n),e},xhr:function xhr(t,e,n){var r=new XMLHttpRequest;r.open("POST",t,!n);try{"withCredentials"in r&&(r.withCredentials=!0)}catch(t){}return r.setRequestHeader("content-type","text/plain"),r.send(e),r},xhrSync:function xhrSync(t,e){return r.xhr(t,e,!0)},img:function img(t){var e=new Image;return e.src=t,e},beacon:function(t,e){return navigator.sendBeacon(t,e)}}},48683:function(t){t.exports=function slice(t,e,n){e||(e=0),void 0===n&&(n=t?t.length:0);for(var r=-1,i=n-e||0,o=Array(i<0?0:i);++r<i;)o[r]=t[e+r];return o}}}]);
//# sourceMappingURL=732.talkdeskchatsdk.js.map